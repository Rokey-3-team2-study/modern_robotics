# Modern Robotics

## Chapter 11. Robot Control, 로봇 제어

> 로봇이 주어진 작업을 정확하고 안정적으로 수행하도록 만드는 것. 작업 요구사항을 바탕으로 각 관절 또는 엔드 이펙터에 가해질 힘/토크를 계산하고 생성

---

### 11.1 Control System Overview, 개요

- 모션 제어 : 특정 경로/위치를 정확히 따라가게 함
- 힘 제어 : 외부 물체와의 접촉에서 일정한 힘을 유지함
- 하이브리드 제어 : 일부 방향엔 모션 제어, 다른 방향엔 힘 제어
- 임피던스 제어 : 로봇을 스프링/댐퍼처럼 동작시킴 (유연한 반응)

---

### 11.2 Error Dynamics, 오차 동역학

- 목표 위치: $\theta_d(t)$
- 실제 위치: $\theta(t)$
- **오차**: $\theta_e(t) = \theta_d(t) - \theta(t)$
- **에러 다이내믹스**는 오차 $\theta_e(t)$가 시간에 따라 어떻게 변하는지를 기술하는 미분 방정식으로 표현됨.

#### 11.2.1 **오차차 응답**
- 오차의 시간 응답은 **transient response** (과도 응답) + **steady-state error** (정상 상태 오차)로 구성됨.
- 성능 측정 지표:
  - **overshoot** (과도하게 튀는 현상)
  - **2% settling time** (최종 값의 ±2% 범위에 도달하는 데 걸리는 시간)
  - **steady-state error** (영구 오차).
- 좋은 오차
  - 정상 상태 오차가 작거나 없다
  - 오버슈트가 작거나 없다
  - 2% 정착 시간이 짧다

#### 11.2.2 **선형 오차 동역학**
- 선형 미분방정식으로 모델링:
  $$
  a_p \theta_e^{(p)} + a_{p-1} \theta_e^{(p-1)} + \dots + a_1 \dot{\theta}_e + a_0 \theta_e = 0
  $$

- 이 방정식이 안정적이려면, **특성 방정식**의 모든 근이 음의 실수부를 가져야 함.

##### 11.2.2.1 **1차 에러 다이내믹스**
- 방정식:
  $$
  \dot{\theta}_e + \frac{1}{t} \theta_e = 0 \quad (\text{시간 상수: } t = \frac{b}{k})
  $$

- 해:
  $$
  \theta_e(t) = e^{-t/\tau} \theta_e(0)
  $$

- 2% 수렴 시간은 약 $4t$ → 스프링 상수 $k$증가 or 감쇠 상수 $b$가 감소하면 응답이 빨라짐

##### 11.2.2.2 **2차 에러 다이내믹스**
- 표준형:
  $$
  \ddot{\theta}_e + 2\zeta \omega_n \dot{\theta}_e + \omega_n^2 \theta_e = 0
  $$
  - $\zeta$ : 감쇠비 (damping ratio)
  - $\omega_n$ : 고유 진동수 (natural frequency)

- 시스템 유형에 따른 반응:
  - **과감쇠** $(\zeta > 1)$ : 느리지만 진동 없음 = 가장 보수적인 결정
  - **임계 감쇠** $(\zeta = 1)$ : 빠르고 진동 없음 = 실용적인 제어
  - **저감쇠** $(\zeta < 1)$: 빠르지만 overshoot 있음

- 오버슈트는 다음과 같이 계산됨:
$$
\text{overshoot} = e^{-\pi \zeta / \sqrt{1-\zeta^2}} \times 100\%
$$

---

### 11.3 Motion Control with Velocity Inputs, 속도 입력에 따른 운동 제어

- 로봇의 각 관절 속도를 직접 제어 할 수 있다는 가정 하에(스페터 모터), 로봇의 위치를 따라 가도록 만드는 제어 시스템

#### 11.3.1.1 **피드포워드 제어**

개념:
- **목표 궤적의 속도** $\dot{\theta}_d(t)$ 를 그대로 입력
- 모델 기반 예측 → **오차 보정 없이 직접 구동**
- 이상적인 상황에서는 정확하지만, 실제 환경에서는 오차 발생

제어 법칙 : $\dot{\theta}(t) = \dot{\theta}_d(t)$

#### 11.3.1.2 **피드백 제어**

개념:
- 현재 위치 $\theta(t)$와 목표 위치 $\theta_d(t)$ 사이의 **오차**를 기반으로 보정
- 외란이나 초기 조건의 차이, 모델 불확실성을 **오차 기반으로 제어**

오차 정의 : $\theta_e(t) = \theta_d(t) - \theta(t)$

P 제어기 + 1차 오차 동역학 : $\dot{\theta}(t) = K_p \theta_e(t) = K_p (\theta_d(t) - \theta(t))$

PI 제어기 + 2차 오차 동역학 : $\dot\theta(t) = K_p \theta_e(t) + K_i \displaystyle \int_0^t \theta_e(t) dt$

- $K > 0$ : 이득 (gain), 큰 값일수록 빠르게 수렴

#### 11.3.1.3 **피드포워드 + 피드백 결합 제어**

개념:
- $\dot{\theta}_d(t)$ 는 빠른 응답성 제공 (예측 기반)
- $\theta_e(t)$ 는 오차를 보정하여 정밀 제어

제어 법칙 : $\dot{\theta}(t) = \dot{\theta}_d(t) + K_p \theta_e(t) + K_i \displaystyle \int^t_0 \theta_e(t) dt$

- 이 식은 **지수적 수렴**을 유도하며, **속도 제어기의 대표 구조**

#### 11.3.2 다중 관절 로봇의 운동 제어

- $n \times n$ 대각 행렬
    - $K_p = k_pI$
    - $K_i = k_iI$

#### 11.3.3 태스크 공간에서의 운동 제어
- 태스크 공간에서 피드포워드와 피드백의 결합 제어:
$$
\mathcal{V}_b(t) = [\text{Ad}_{X^{-1}X_d}]\mathcal{V}_d(t) + K_pX_e(t) + K_i\int^t_0X_e(t)dt
$$

- $\mathcal{V}_b(t)$를 구현하는 지시 관절 속도 $\dot{\theta}$ 계산 : $\dot{\theta} = J^{\dagger}_b(\theta)\mathcal{V}_b$

---

### 11.4 Motion Control with Torque or Force Inputs, 토크, 힘 입력에 따른 운동 제어

기본 개념
- 이전의 속도 제어나 위치 제어는 로봇이 **속도 명령을 잘 따라가게 만드는 제어** 방식이었음.
- 토크/힘 제어는 **실제 로봇 관절에 인가되는 토크를 직접 제어**하는 방식.
- **로봇의 동역학 모델**을 활용하여 비선형성(관성, 코리올리, 중력 등)을 보상하고, 보다 정밀한 제어 성능을 제공.

#### 11.4.1 단일 관절 제어

- 개념 : 비선형 동역학을 갖는 단일 관절 시스템, 중력과 마찰을 포함하는 일반적인 모델
- 링크의 동역학 : ${\tau = M \ddot{\theta} + \text{m}gr\cos{\theta} + b\dot{\theta}}$
  - $\tau$ : 입력토크
  - $M$ : 관절의 회전 관성
  - $\ddot{\theta}$ : 관절 가속도
  - $b\dot{\theta}$ : 점성 마찰 항

#### 11.4.1.1 피드백 제어: PID 제어

- PID 제어기
  $$
  \tau = K_p\theta_e + K_i\int\theta_e(t)dt + K_d\dot{\theta}_e
  $$
  - $K_p$ : 비례 이득(Proportional Gain)
    - 역할 : 제어 입력이 오차에 비례하여 커짐
    - 효과 : 오차를 빠르게 줄임
  - $K_i$ : 적분 이득(Integral Gain)
    - 역할 : 오차를 시간에 대해 누적해서 보상, 영구적인 steady-state 오차 제거
    - 효과 : 지속적인 작은 오차도 시간이 지나면 제어 입력이 커짐
  - $K_d$ : 미분 이득(Derivative Gain)
    - 역할 : 빠르게 변하는 오차에 대해 제어 입력을 조절 → 감쇠(damping) 역할
    - 효과 : 진동 억제, 과도 응답 안정화
- PD 제어와 2차 오차 동역학
  $$
  M \ddot{\theta} + (b + K_d)\dot{\theta}_e + K_p\theta_e = 0
  $$
  - 중력항을 $\text{m}gr\cos{\theta}$  무시하거나 보상했다고 가정함함
  - 이때 시스템은 **2차 선형 시스템**이 되어,
    - $K_p$ : 복원력(스프링 상수)
    - $K_d + b$ : 감쇠(damping)
    - $M$ : 회전 관성
- PID 제어와 3차 오차 동역학
  $$
  M\theta^{(3)}_e + (b+K_d)\ddot{\theta}_e + K_p\dot{\theta}_e + K_i\theta_e = \dot{\tau}_{\text{dist}}
  $$
  - 이 식은 **PID 제어를 포함한 시스템의 전체 동역학**을 보여줌
  - $\dot{\tau}_{\text{dist}}$ : 외란의 시간 미분

#### 11.4.1.2 피드포워드 제어

- 개요
  - **오차가 발생한 뒤에 반응하는 피드백 제어와 달리**, 피드포워드 제어는 **로봇의 동역학 모델을 사용하여 선제적으로 토크를 생성**합니다.
  - 목표는 궤적 $\theta_d(t), \dot{\theta}_d(t), \ddot{\theta}_d(t)$를 **예측 기반으로 정확히 추종**하는 것.

- 동역학 모델 기반 제어식
  - 컨트롤러가 사용하는 모델:
    $$
    \tau = \tilde{M}(\theta)\ddot{\theta} + \tilde{h}(\theta, \dot{\theta})
    $$
    - $\tilde{M}(\theta)$ : 추정된 질량/관성 행렬  
    - $\tilde{h}(\theta, \dot{\theta})$ : 추정된 코리올리, 중력 등 비선형 항
  - 이 모델이 완벽하면 $\tilde{M} = M, \tilde{h} = h$ 이고, 이상적으로 궤적을 정확히 따를 수 있음.

- **피드포워드 토크 계산**
  $$
  \tau(t) = \tilde{M}(\theta_d(t))\ddot{\theta}_d(t) + \tilde{h}(\theta_d(t), \dot{\theta}_d(t))
  $$
  - 이 식은 **원하는 궤적에 필요한 토크를 선제적으로 계산**하는 것이다.

- **한계점**
  - **모델링 오차에 민감**: 예를 들어 질량 중심 위치가 잘못 설정되었을 경우, 추종 에러가 발생할 수 있음.
  - 실제 환경에서는 외란, 마찰, 모델 불완전성 등의 이유로 **단독 피드포워드 제어는 사용되지 않음**.

#### 11.4.1.3 피드포워드와 프드백 선형화의 결합

- 핵심 아이디어
  - 이상적인 동역학 모델 $\{\tilde{M}, \tilde{h}\}$을 사용하여 **비선형 로봇 시스템을 선형 시스템처럼 제어**하는 방식.
  - 실제 시스템에 오차가 존재하므로 피드백 제어와 반드시 함께 사용해야 한다.

- 원하는 오차 다이내믹스는 다음과 같은 **PID 기반 선형 시스템**:
  $$
  \ddot{e} + K_d \dot{e} + K_p e + K_i \int e(t)\, dt = c
  $$
- 명령 가속도:
  $$
  \ddot{\theta} = \ddot{\theta}_d + K_d \dot{e} + K_p e + K_i \int e(t)\, dt
  $$

- 위 명령 가속도를 로봇 동역학 모델에 대입하여 토크 제어기를 얻음:
  $$
  \tau = \tilde{M}(\theta)(\ddot{\theta}_d + K_d \dot{e} + K_p e + K_i \int e(t)\, dt) + \tilde{h}(\theta, \dot{\theta})
  $$
  - $\tilde{M}(\theta)$ : 추정 질량 행렬 (관성)
  - $\tilde{h}(\theta, \dot{\theta})$ : 추정 코리올리 + 중력 항
  - 이 식은 **선형 PID 컨트롤러 + 동역학 보상기**라고 해석할 수 있음.

- 특징
  - **피드포워드**: $\ddot{\theta}_d$를 이용한 예정된 동작 보상
  - **피드백 선형화**: 비선형 동역학을 상쇄하고 선형 시스템처럼 제어
  - **오차 수렴 보장**: PID 이득에 따라 오차가 지수적으로 감소

- 장점
  - 비선형 로봇 시스템의 정밀한 궤적 추종 가능
  - 좋은 모델만 있다면 성능 매우 우수
  - 피드백을 통해 모델링 오차 보정 가능

#### 11.4.2 다관절 로봇 제어

- 다중 관절 로봇을 아래 두 가지로 구분
  - 각 관절 간 정보 공유 없이 별도로 제어되는 **분산형 제어**,
  - 각 관절에 대해 전체 상태 정보를 사용해 각 관절 제어를 계산하는 **중앙 집중형 제어**

#### 11.4.2.1 분산형 다중 관절 제어

- 개념
  - 각 관절을 **독립적인 단일 관절 시스템**처럼 제어.
  - 관절 간의 **상호 작용(코리올리 항, 커플링 등)을 무시**하고 제어기를 구성.
- 제어 방식
  - 각 관절의 제어기는 다음과 같은 단순 모델에 기반함 : $I_i \ddot{q}_i = \tau_i$
    - $I_i$ : 관절 $i$의 관성
    - $q_i$ : 관절 위치
    - $\tau_i$ : 입력 토크
- ✅장점
  - 구조가 단순하고 구현이 쉬움.
  - 실시간 제어가 쉬움 (병렬 제어 가능).
- ⚠️단점
  - 관절 간 상호작용 무시 → 정확도 떨어짐.
  - 빠르고 정밀한 동작에는 부적절.

#### 11.4.2.2 중앙 집중형 다중 관절 제어

- 개념
  - **로봇 전체의 동역학 모델**을 사용하여 모든 관절의 토크를 동시에 계산.
  - 관절 간 커플링, 코리올리 항, 중력항 등을 **정확히 보상**.
- 제어 방식
  - 동역학 방정식 : $M(q)\ddot{q} + C(q, \dot{q})\dot{q} + G(q) = \tau$
  - 제어기 : $\tau = M(q)\ddot{q}_d + C(q, \dot{q})\dot{q}_d + G(q) + M(q)(K_v \dot{e} + K_p e)$
- ✅장점
  - 커플링 보상으로 정밀하고 빠른 제어 가능.
  - 제어 오차 최소화.
- ⚠️단점
  - 계산량이 많고 실시간 제어에 부담.
  - 모델 정확도에 민감 → 모델링 오류가 성능 저하로 직결.

#### 11.4.3 태스크 공간 제어

- 개념
  - 조인트 공간 제어는 $q$ (관절 각도)를 제어하지만, 실제 작업은 보통 로봇의 엔드 이펙터 위치/자세 $x \in \mathbb{R}^6$을 다룸.
  - 따라서, **태스크 공간에서 원하는 궤적** $x_d(t)$, $\dot{x}_d(t)$, $\ddot{x}_d(t)$를 따라가기 위한 제어기를 설계해야 함.
    - 이 제어기는 실제 시스템의 비선형성과 동역학 항을 모두 보상하면서, 태스크 공간에서의 궤적 추종 성능을 갖도록 설계
    - 잘 조정된 $K_p, K_v$로 **오차 수렴을 보장**함.

- 기본 관계: 태스크 공간 가속도
  - 태스크 공간 가속도는 다음과 같이 표현: $\ddot{x} = J(q)\ddot{q} + \dot{J}(q, \dot{q})\dot{q}$
    - $J(q)$ : 자코비안
    - $\dot{J}(q, \dot{q})$ : 자코비안의 시간 미분

- 목표: 원하는 태스크 공간 궤적 추종
  - 목표는: $\ddot{x} = \ddot{x}_d + K_v(\dot{x}_d - \dot{x}) + K_p(x_d - x)$
  - 이 식은 **PD 제어기**를 기반으로 한 **이상적인 궤적 추종 오차 다이내믹스**를 의미함.

- 제어 토크 식 도출
  - 관절 공간 동역학: $M(q)\ddot{q} + C(q, \dot{q})\dot{q} + G(q) = \tau$
  - 위 식을 태스크 공간 제어로 확장하면 제어 입력 \( \tau \)는 다음과 같이 주어짐:
    $$
    \tau = M(q)J^{\#}(q)(\ddot{x}_d + K_v\dot{e} + K_pe - \dot{J}(q, \dot{q})\dot{q}) + C(q, \dot{q})\dot{q} + G(q)
    $$
    - $e = x_d - x$
    - $J^{\#}(q)$: 자코비안의 유사역행렬 (Moore-Penrose pseudo-inverse)

---

### 11.5 Force Control, 힘 제어

- 개요
  - 자유 공간에서는 위치 제어가 적합, 접촉 시에는 힘 제어가 중요.
  - 엔드 이펙터의 운동을 만드는 것이 아니라, 환경에 힘과 토크를 적용하는 것
  - 로봇이 외부 환경과 접촉 중일 때, 원하는 힘(wrench) 을 유지하면서 동작하도록 제어하는 방식.

- 기본 다이나믹스
  $$
  M(\theta)\ddot{\theta} + c(\theta, \dot{\theta}) + g(\theta) + b(\dot{\theta}) + J^T(\theta)F_{tip} = \tau
  $$
  - $F_{tip}$ : 로봇이 환경에 가하는 렌치
  - $g(\theta) + J^T(\theta)F_{tip} = \tau$ : 힘 제어에서는 로봇이 느리게 움직이므로 가속도, 속도 항 무시 가능

- 오픈 루프 힘 제어(피드포워드 기반)
  - 로봇 엔드 이펙터에서 직접 측정되지 않는 힘-토크가 있을 경우:
    $$
    \tau = \tilde{g}(\theta) + J^T(\theta)F_d
    $$
    - $\tilde{g}(\theta)$ : 중력 보상 모델
    - $F_d$ : 원하는 힘 (목표 렌치)

- 센서 기반 PI 힘 제어기
  - 6축 힘/토크 센서를 사용하는 피드백 제어기:
    $$
    \tau = \tilde{g}(\theta) + J^T(\theta)\left(F_d + K_{fp}F_e + K_{fi}\int F_e(t)\,dt\right)
    $$
    - $F_e = F_d - F_{tip}$: 힘 오차
    - $K_{fp}, K_{fi}$: 비례/적분 이득 (양의 정부호 행렬)
  - 이 식을 동역학 모델에 대입하면 오차 수렴 보장:
    $$
    K_{fp}F_e + K_{fi}\int F_e(t)\,dt = 0
    $$
    - 시간에 따라 $F_e \to 0$

- 안정성 및 수정
  - 중력 모델이 부정확하면 일정한 외란이 생김 → 이를 고려해 미분:
    $$
    (K_{fp} + I) \dot{F}_e + K_{fi}F_e = 0
    $$
  - 단, 이 제어기를 잘못 사용할 경우 위험할 수 있음:
  - 로봇이 저항이 없는 공간에서 힘을 주려고 하면 가속이 커짐 → **가속도 제한 또는 감쇠 항 추가**:
    $$
    \tau = \tilde{g}(\theta) + J^T(\theta)\left(F_d + K_{fp}F_e + K_{fi}\int F_e(t)\,dt - K_{damp}V\right)
    $$

---

### 11.6 Hybrid Motion-Force Control, 하이브리드 운동-힘 제어
- 개요
  - 힘을 제어해야 하는 대부분의 작업에서는 운동도 제어해야 한다.
  - 운동과 힘을 분리하여 동시에 제어하는 것이 하이브리드 제어의 핵심.

#### 11.6.1 자연적 및 인공적 제약 조건
- 자연적 제약 : 로봇이 외부 환경과 물리적으로 접촉할 때 발생.
- 인공적 제약 : 작업 목적에 따라 의도적으로 부여한 제약.
- 이러한 제약 조건에 따라 로봇의 **작업공간**(task space)이 운동 제어 영역과 힘 제어 영역으로 분할됨.

#### 11.6.2 하이브리드 운동 - 힘 제어기
- 개념
  - **자연 제약 조건**은 작업 공간(task space) 속도 $V \in \mathbb{R}^6$에 대해 파피안 제약 조건으로 표현
  $$
  A(\theta) V = 0 
  $$

- 제어기 설계
  1. 동역학
      - 제약 조건 없을 때 : $F = \Lambda(\theta) \dot{V} + \eta(\theta, V)$
      - 제약 조건 있을 때 : $F = \Lambda(\theta) \dot{V} + \eta(\theta, V) + A^T(\theta)\lambda$
        - $A^T(\theta)\lambda = \mathcal{F}_{\text{tip}}$는 제약 조건에 대해 로봇이 가하는 렌치
        - 이때 $\lambda \in \mathbb{R}^k$는 라그랑주 승수 = 제약에 대한 반작용력
    2. 속도 제약의 시간 미분
    $$A(\theta)\dot{V} + \dot{A}(\theta)V = 0$$
  3. 가속도 명령
    $$A(\theta)\dot{V}_d = -\dot{A}(\theta)V$$
  4. 위 식들로부터 라그랑주 승수 $\lambda$ 계산
    $$
    \lambda = \left( A \Lambda^{-1} A^T \right)^{-1} \left[ A \Lambda^{-1} (F - \eta) - \dot{A} V \right]
    $$
  5. 이때 로봇이 제약 방향으로 가하는 렌치
    $$
    F_{\text{tip}} = A^T(\theta) \lambda
    $$

- 투영 행렬을 통한 운동/힘 분리
  - 운동 제어 방향으로의 투영 행렬 $P(\theta)$ 정의:
    $$
    P = I - A^T \left( A \Lambda^{-1} A^T \right)^{-1} A \Lambda^{-1}
    $$
  - 제어 입력을 두 부분으로 나눠 하이브리드 제어기 구성:
    $$
    \tau = J_b^T(\theta)\left[
    \underbrace{P(\theta)\left( \Lambda(\theta)\dot{V}_d + \eta(\theta, V) \right)}_{\text{운동 제어}} +
    \underbrace{(I - P(\theta)) F_d}_{\text{힘 제어}} +
    \underbrace{\tilde{\eta}(\theta, \mathcal{V}_b)}_{\text{코리올리 힘과 중력}}
    \right]
    $$
      - $J_b(\theta)$ : 바디 프레임 기준 자코비안
      - $F_d$ : 원하는 힘 제어값
      - 각 항들은 운동과 힘 제어의 작업 공간 내 독립된 서브공간에 투영됨.

---

### 11.7 Impedance Control, 임피던스 제어

- 개요
  - 임피던스 제어는 로봇이 입력된 위치나 속도 명령에 따라 힘으로 반응하게 만드는 방식
    - 이상적인 운동 제어 = 높은 임피던스(방해 힘으로 인한 운동 변화가 적음)에 해당
    - 이상적인 힘 제어 = 낮은 임피던스(운동 방해로 인한 힘 변화가 적음)에 해당
  - 어드미턴스 제어는 입력된 외부 힘에 따라 로봇이 위치나 속도를 조절하는 방식

#### 11.7.1 임피던스 제어 알고리즘

- 목표
  - 힘 제어보다는 **동작의 반응성**(flexible response)을 제어
  - 로봇의 궤적이 외부 힘에 따라 유연하게 반응하도록 만듦.

- 제어 법칙
  $$
  M_d \ddot{x} + B_d \dot{x} + K_d(x - x_d) = f_{\text{ext}}
  $$
  - $F$ : 외부에서 측정된 힘
  - $x$ : 현재 위치
  - $x_d$ : 원하는 위치
  - $M_d, B_d, K_d$ : 가상 질량, 감쇠, 스프링 계수

#### 11.7.2 어드미턴스 제어 알고리즘

- 목표
  - **로봇이 받는 힘을 받아서**, 거기에 맞는 **속도/가속도/위치 명령을 생성**함.
  - 일반적으로 **하드웨어가 힘 제어에 부적합한 경우 사용**.
- 제어 법칙
  $$
  M_d \ddot{x}_d + B_d \dot{x}_d + K_d(x_d - x) = f_{\text{ext}}
  $$
    - 여기서 제어 대상은 $x_d$, 즉 원하는 위치/속도 명령이 됨. 
    - 이를 다시 속도 명령 등으로 변환하여 **기존 위치 기반 제어기에 넘김**.

---

### 11.8 Low-Level Joint Force/Torque Control, 낮은 수준의 관절 힘-토크 제어

- 각 관절에 작용하는 힘-토크의 정밀 제어가 목적

---

### 11.9 Other Topics

- 강인제어, Robust Control
- 적응제어, Adaptive Control
- 반복 학습 제어, Iterative Learning Control
- 수동적 컴플라이언스와 유연한 매니퓰레이터
- 가변 임피던스 구동기, variable-impedence actuator
- 가변 강성 구동기, variable-stiffiness actuator

---

### Summary

### 🔧 **1. 제어 시스템 개요**
- 로봇 제어는 **명령된 움직임이나 힘을 로봇이 정확히 수행하도록** 힘/토크를 생성하는 과정임.
- **입력**: 위치/속도/힘 목표  
  **출력**: 관절에 적용되는 토크나 힘
- 제어 전략은 크게 다음 4가지로 나뉨:
  1. Motion Control (위치 제어)
  2. Force Control (힘 제어)
  3. Hybrid Motion–Force Control
  4. Impedance Control (임피던스 제어)


### 🎯 **2. 에러 다이내믹스 (Error Dynamics)**
- 목표값과 실제값 간의 오차 $\theta_e(t)$를 추적하여 이를 0으로 줄이는 것이 제어 목표.
- **PD 제어기** 설계로 간단한 위치 제어가 가능함.


### ⚙️ **3. 속도 입력 기반 위치 제어 (Motion Control with Velocity Inputs)**
- **입력이 속도**일 경우, 관절 또는 태스크 공간 위치 추적을 위해 속도 제어기를 구성.
- 공간/바디 Jacobian을 이용해 task-space 제어도 가능.
- 적절한 `θ̇ = K e(t)` 피드백으로 안정적인 제어 가능.


### 💪 **4. 토크/힘 입력 기반 위치 제어 (Motion Control with Torque or Force Inputs)**
- 로봇 동역학을 활용해 더 정밀한 제어 가능.
- 대표적 기법: **Computed Torque Control**
  - `τ = M(θ)θ̈_d + C(θ,θ̇)θ̇_d + G(θ) + PD feedback`
  - 비선형 동역학을 보정하고 선형 시스템처럼 제어함.
- 다양한 로봇에 적용 가능한 강력한 제어 방식.


### 🧱 **5. 힘 제어 (Force Control)**
- 로봇이 외부 물체와 접촉할 때 원하는 **힘을 유지**하도록 제어.
- 원하는 접촉력과 실제 접촉력 사이의 오차를 제어함.


### 🔀 **6. 하이브리드 모션–포스 제어 (Hybrid Motion–Force Control)**
- 한 방향에는 위치 제어, 다른 방향에는 힘 제어를 동시에 적용.
- 예: 칠판에 분필을 누르며 글씨를 쓸 때 → 수직은 힘 제어, 평면은 위치 제어.
- **자연적 제약 vs 인공 제약** 구분해서 설계.


### 🌀 **7. 임피던스 제어 / 어드미턴스 제어**
- 로봇이 **탄성체(스프링/댐퍼/질량)**처럼 행동하도록 제어함.
- 로봇이 받은 힘에 따라 자연스럽게 움직이게 하거나, 원하는 힘-위치 관계를 설정.
  - **임피던스 제어**: 위치 제어기가 내재된 가상 스프링/댐퍼 설계.
  - **어드미턴스 제어**: 힘 입력에 따라 위치 출력이 정해짐.
- 특히 **불확실한 접촉 환경**에서 유용.


### 🧩 **8. 저수준 관절 제어**
- 실제 하드웨어에선 각 관절마다 로컬 제어 루프 존재.
- 센서 노이즈, 마찰, 기어 이득 등 고려해야 함.
